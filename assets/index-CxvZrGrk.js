var O=Object.defineProperty;var k=(n,e,t)=>e in n?O(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var u=(n,e,t)=>k(n,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))s(l);new MutationObserver(l=>{for(const a of l)if(a.type==="childList")for(const d of a.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&s(d)}).observe(document,{childList:!0,subtree:!0});function t(l){const a={};return l.integrity&&(a.integrity=l.integrity),l.referrerPolicy&&(a.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?a.credentials="include":l.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(l){if(l.ep)return;l.ep=!0;const a=t(l);fetch(l.href,a)}})();class L{constructor(e,t){u(this,"x");u(this,"y");this.x=e,this.y=t}isNeighbor(e){return e.x==this.x&&Math.abs(e.y-this.y)==1||e.y==this.y&&Math.abs(e.x-this.x)==1}isEqual(e){return this.x===e.x&&this.y===e.y}update(e){this.x=e.x,this.y=e.y}}class R{constructor(e,t){u(this,"position");u(this,"color");u(this,"element",null);this.position=new L(e.x,e.y),this.color=t}bindElement(e){this.element=e}select(){var e;(e=this.element)==null||e.select()}unselect(){var e;(e=this.element)==null||e.unselect()}disable(){var e;(e=this.element)==null||e.disable()}}class S{constructor(e,t){u(this,"_width");u(this,"_height");u(this,"id");u(this,"uniqueColors");u(this,"field");u(this,"selectedThing",null);u(this,"connectedThings",0);this.id=e;const s=[...t];s.sort((d,o)=>o.x-d.x);const l=s[0].x;s.sort((d,o)=>o.y-d.y);const a=s[0].y;this._width=l+1,this._height=a+1,this.field=Array.from({length:this._height},()=>Array.from({length:this._width},()=>null)),this.uniqueColors=new Set,t.forEach(d=>{const{x:o,y:r,color:i}=d;this.field[r][o]=new R(new L(o,r),i),this.uniqueColors.add(i)})}get width(){return this._width}get height(){return this._height}canConnect(e,t){return new Promise((s,l)=>{e.color!==t.color&&l(!1);const{x:a,y:d}=e.position,o=[{x:a,y:d}],r=[];for(;o.length;){const{x:i,y:c}=o.pop();r.some(h=>h.x===i&&h.y===c)||(t.position.isNeighbor(new L(i,c))&&s(!0),i-1>=0&&!this.field[c][i-1]&&o.push({x:i-1,y:c}),i+1<this._width&&!this.field[c][i+1]&&o.push({x:i+1,y:c}),c-1>=0&&!this.field[c-1][i]&&o.push({x:i,y:c-1}),c+1<this._height&&!this.field[c+1][i]&&o.push({x:i,y:c+1}),r.push({x:i,y:c}))}l(!1)})}countThings(){let e=0;for(let t=0;t<this._height;t++)for(let s=0;s<this._width;s++)this.field[t][s]&&(e+=1);return e}async tryToSelect(e,t){const s=this.field[t][e];if(!s)return"nothing";if(!this.selectedThing)return s.select(),this.selectedThing=s,"selected";if(this.selectedThing.position.x===e&&this.selectedThing.position.y===t)return this.selectedThing.unselect(),this.selectedThing=null,"unselected";try{return await this.canConnect(this.selectedThing,s),this.selectedThing.unselect(),this.selectedThing.disable(),this.field[this.selectedThing.position.y][this.selectedThing.position.x]=null,this.field[s.position.y][s.position.x]=null,this.selectedThing=null,s.disable(),this.connectedThings+=2,this.countThings()?"connected":"win"}catch{return this.selectedThing.unselect(),this.selectedThing=null,"notConnected"}}reset(){for(let e=0;e<this._height;e++)for(let t=0;t<this._width;t++);}}class V{constructor(){u(this,"levels",{})}createLevel(e){this.levels[e]=new S(e,[{x:4,y:4,color:"#FFFF00"},{x:4,y:6,color:"#FFFF00"},{x:2,y:2,color:"#FF0000"},{x:3,y:2,color:"#00FF00"},{x:2,y:3,color:"#00FF00"},{x:3,y:3,color:"#0000FF"},{x:6,y:3,color:"#FFFF00"},{x:2,y:4,color:"#FF00FF"},{x:3,y:4,color:"#00FFFF"},{x:5,y:4,color:"#00FFFF"},{x:6,y:4,color:"#800080"},{x:3,y:5,color:"#FFFF00"},{x:4,y:5,color:"#FFA500"},{x:5,y:5,color:"#800080"},{x:6,y:5,color:"#FF0000"},{x:3,y:6,color:"#0000FF"},{x:5,y:6,color:"#FFA500"},{x:6,y:6,color:"#FF00FF"}])}resetLevel(e){this.levels[e]=new S(e,[{x:4,y:4,color:"#FFFF00"},{x:4,y:6,color:"#FFFF00"},{x:2,y:2,color:"#FF0000"},{x:3,y:2,color:"#00FF00"},{x:2,y:3,color:"#00FF00"},{x:3,y:3,color:"#0000FF"},{x:6,y:3,color:"#FFFF00"},{x:2,y:4,color:"#FF00FF"},{x:3,y:4,color:"#00FFFF"},{x:5,y:4,color:"#00FFFF"},{x:6,y:4,color:"#800080"},{x:3,y:5,color:"#FFFF00"},{x:4,y:5,color:"#FFA500"},{x:5,y:5,color:"#800080"},{x:6,y:5,color:"#FF0000"},{x:3,y:6,color:"#0000FF"},{x:5,y:6,color:"#FFA500"},{x:6,y:6,color:"#FF00FF"}])}}const y=new V;var G="clfprl0",K="yfu9qt0",Z="di7b3j0",z="di7b3j1",D="di7b3j2",J="di7b3j3",Q="di7b3j4",W="di7b3j5";const N=()=>{const n=document.createElement("div");return n.className=Z,n},C=(n,e)=>{const t=document.createElement("button");return t.className=D,t.textContent=n,t.onclick=e,t},M=n=>{const e=document.createElement("h1");return e.className=z,e.textContent=n,e},X=()=>{const n=document.createElement("div");return n.className=J,n},Y=()=>{const n=document.createElement("div");return n.className=Q,n},_=n=>{const e=document.createElement("p");return e.className=W,e.textContent=n,e};var U="u5papc0",ee="u5papc1",te="u5papc2",ne="u5papc3",oe="u5papc4",q="u5papc5",P="u5papc6",se="u5papc7";const ie=()=>{const n=document.createElement("div");return n.className=ee,n},le=()=>{const n=document.createElement("div");return n.className=te,n},ce=(n,e)=>{const t=document.createElement("div");return t.style.setProperty("--columns",n.toString()),t.style.setProperty("--rows",e.toString()),t.className=se,t},I=(n,e)=>{const t=document.createElement("div");return t.className=ne,t.onclick=n,e?(t.style.setProperty("--bg-color",e),t.classList.add(oe)):t.classList.add(q),{element:t,select:()=>{t.classList.add(P)},unselect:()=>{t.classList.remove(P)},disable:()=>{t.classList.add(q)}}},w=n=>{const e=document.createElement("p");return e.className=U,e.textContent=n,e};function j(n){return n<10?"0"+n:n.toString()}const A=new CustomEvent("gotomenu"),re=new CustomEvent("levelSelection");var g;(n=>{const e=document.getElementById("app"),t=[];document.body.classList.add(K),e.className=G;function s(){d();const o=N(),r=M('Игра "Соедини 2 кубика"'),i=C("Выбрать уровень",()=>{document.dispatchEvent(re)});o.appendChild(r),o.appendChild(i),e.appendChild(o)}n.drawMenu=s;function l(o){d();const r=N(),i=M("Выбери уровень"),c=X(),f=C("Назад",()=>{document.dispatchEvent(A)});o.forEach(h=>{const m=Y();m.appendChild(_(`${h.width} x ${h.height}`)),m.appendChild(_(`${[...h.uniqueColors].length} цветов`));const x=()=>{const E=new CustomEvent("playLevel",{detail:{id:h.id}});document.dispatchEvent(E)};m.addEventListener("click",x),t.push(()=>{m.removeEventListener("click",x)}),c.appendChild(m)}),r.appendChild(i),r.appendChild(c),r.appendChild(f),e.appendChild(r)}n.drawLevelSelection=l;function a(o){d();const r=ie(),i=le(),c=w("Счёт: 0"),f=w(`Уровень ${o.id+1}`),h=w("00:00");let m=0;i.appendChild(c),i.appendChild(f),i.appendChild(h),r.appendChild(i);const x=ce(o.width,o.height),E=setInterval(()=>{m+=1;const p=j(Math.floor(m/60)),F=j(m%60);h.textContent=`${p}:${F}`},1e3);for(let p=o.field.length-1;p>=0;p--)for(let F=0;F<o.field[p].length;F++){const v=o.field[p][F],T=v?I(()=>{o.tryToSelect(F,p).then(B=>{switch(B){case"connected":{c.textContent=`Счёт: ${Math.floor(o.connectedThings/2)}`;break}case"notConnected":{alert("Нельзя соединить эти кубики!");break}case"win":{c.textContent=`Счёт: ${Math.floor(o.connectedThings/2)}`,clearInterval(E),alert("Победа!");const H=new CustomEvent("playLevel",{detail:{id:o.id+1}}),b=C("Следующий уровень",()=>{document.dispatchEvent(H)}),$=C("В меню",()=>{document.dispatchEvent(A)});b.style.marginTop="20px",r.appendChild(b),r.appendChild($);break}}})},v.color):I(()=>{});v&&v.bindElement(T),x.appendChild(T.element)}r.appendChild(x),e.appendChild(r)}n.drawLevel=a;function d(){for(e.replaceChildren();t.length;)t.pop()()}n.clearInterface=d})(g||(g={}));class ae{constructor(){u(this,"leaderboard",[]);document.addEventListener("gotomenu",()=>{this.setMenuStage()}),document.addEventListener("levelSelection",()=>{this.setLevelSelectionStage()}),document.addEventListener("playLevel",e=>{const s=e.detail.id;this.setPlayingStage(s)})}setMenuStage(){g.drawMenu()}setLevelSelectionStage(){g.drawLevelSelection(Object.values(y.levels))}setPlayingStage(e){y.levels[e]?(y.resetLevel(e),g.drawLevel(y.levels[e])):this.setLevelSelectionStage()}}const de=new ae;y.createLevel(0);y.createLevel(1);de.setMenuStage();
